---
import { Sun, Moon, Menu, X } from 'lucide-astro'
import { Image } from 'astro:assets'
import Logo from '../images/Logo.png'
---

<nav
  id="navbar"
  class="fixed top-0 left-0 w-full z-50 bg-(--color-bg) text-(--color-text) shadow transition-transform duration-500 ease-in-out"
>
  <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
    <!-- Logo + Title -->
    <div class="flex items-center space-x-2">
      <a href="/" class="flex items-center space-x-2">
        <Image
          src={Logo}
          alt="Logo"
          class="h-14 w-14 transition-transform duration-500 hover:rotate-45"
        />
        <h1 class="text-2xl font-bold">Nutthawit</h1>
      </a>
    </div>

    <!-- Desktop Navigation -->
    <ul class="hidden md:flex space-x-6">
      <li>
        <a href="/" class="hover:text-(--color-accent) transition">Home</a>
      </li>
      <li>
        <a href="#" class="hover:text-(--color-accent) transition">About</a>
      </li>
      <li>
        <a href="#" class="hover:text-(--color-accent) transition">Contact</a>
      </li>
    </ul>

    <!-- Theme Toggle + Hamburger -->
    <div class="flex items-center space-x-4">
      <!-- Theme Toggle -->
      <button
        id="theme-toggle"
        class="relative w-14 h-8 rounded-full bg-gray-300 dark:bg-gray-700 flex items-center transition-all duration-300 focus:outline-none"
        aria-label="Toggle theme"
      >
        <div
          id="toggle-circle"
          class="absolute left-1 top-1 w-6 h-6 rounded-full bg-white dark:bg-(--color-accent) shadow-md transition-all duration-300 flex items-center justify-center"
        >
          <Sun
            class="w-4 h-4 text-[#ff6600] transition-all duration-300 opacity-100 dark:opacity-0"
          />
          <Moon
            class="w-4 h-4 text-white absolute transition-all duration-300 opacity-0 dark:opacity-100"
          />
        </div>
      </button>

      <!-- Hamburger Button (Mobile) -->
      <button
        id="menu-toggle"
        class="md:hidden p-2 rounded focus:outline-none transition-colors"
        aria-label="Toggle menu"
      >
        <Menu class="w-6 h-6 text-(--color-text) transition-all duration-300" />
        <X
          class="w-6 h-6 text-(--color-text) absolute opacity-0 transition-all duration-300"
        />
      </button>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="md:hidden max-h-0 overflow-hidden transition-all duration-500 ease-in-out bg-(--color-bg) text-(--color-text)"
  >
    <ul class="flex flex-col items-center space-y-4 py-4">
      <li>
        <a href="/" class="hover:text-(--color-accent) transition">Home</a>
      </li>
      <li>
        <a href="#" class="hover:text-(--color-accent) transition">About</a>
      </li>
      <li>
        <a href="#" class="hover:text-(--color-accent) transition">Contact</a>
      </li>
    </ul>
  </div>
</nav>

<script type="module">
  const navbar = document.getElementById('navbar')
  const html = document.documentElement
  const toggle = document.getElementById('theme-toggle')
  const circle = document.getElementById('toggle-circle')

  // Navbar scroll animation
  let lastScroll = 0
  window.addEventListener('scroll', () => {
    if (!navbar) return
    const currentScroll = window.pageYOffset
    navbar.style.transform =
      currentScroll > lastScroll ? 'translateY(-100%)' : 'translateY(0)'
    lastScroll = currentScroll
  })

  // Load theme
  if (localStorage.getItem('theme') === 'dark') {
    html.classList.add('dark')
    circle.style.transform = 'translateX(24px)'
  } else {
    html.classList.remove('dark')
    circle.style.transform = 'translateX(0)'
  }

  // Toggle dark/light
  toggle?.addEventListener('click', () => {
    const isDark = html.classList.toggle('dark')
    circle.style.transform = isDark ? 'translateX(24px)' : 'translateX(0)'
    localStorage.setItem('theme', isDark ? 'dark' : 'light')
  })

  // Mobile menu logic
  const menuToggle = document.getElementById('menu-toggle')
  const mobileMenu = document.getElementById('mobile-menu')
  const menuIcon = menuToggle?.querySelector('svg:first-child')
  const closeIcon = menuToggle?.querySelector('svg:last-child')

  let menuOpen = false
  menuToggle?.addEventListener('click', () => {
    menuOpen = !menuOpen
    mobileMenu.style.maxHeight = menuOpen ? mobileMenu.scrollHeight + 'px' : '0'
    menuIcon.style.opacity = menuOpen ? '0' : '1'
    closeIcon.style.opacity = menuOpen ? '1' : '0'
  })
</script>
